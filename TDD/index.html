<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Target-Driven Distillation">
  <meta name="keywords" content="Diffusion Model, Consistency Models">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Target-Driven Distillation</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-Y5ZVQZ7NHC"></script> -->
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">
  <!-- <link rel="icon" href="./static/images/favicon.svg"> -->


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="static/js_slide/fontawesome.all.min.js"></script>
  <script src="static/js_slide/bulma-carousel.min.js"></script>
  <script src="static/js_slide/bulma-slider.min.js"></script>
  <script src="static/js_slide/index.js"></script>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>

  <!-- Vendor Stylesheets -->
  <!--=================js==========================-->
  <link rel="stylesheet" href="static/css/tab_gallery.css">
  <link rel="stylesheet" href="static/css/juxtapose.css">
  <link rel="stylesheet" href="static/css/image_card_fader.css">
  <link rel="stylesheet" href="static/css/image_card_slider.css">
</head>
<body>




<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <!-- <h1 class="title is-1 publication-title"><span style="color:#5e5ed2; font-weight: bold; font-style: italic"><strong>PCM</strong></span> : Phased Consistency Model</h1> -->
          <h1 class="title is-1 publication-title">
            TDD: Target-Driven Distillation
          </h1>
          <h3 class="title is-3 publication-title">
            Consistency Distillation with Target Timestep Selection and Decoupled Guidance
          </h3>
          <div class="is-size-5 publication-authors">
            <div class="author-block"><a href="https://github.com/WangCunzheng">Cunzheng Wang</a><sup>1, 2</sup>, </div>
            <div class="author-block">Ziyuan Guo</a><sup>2</sup>, </div>
            <div class="author-block"><a href="https://github.com/Ldhlwh">Yuxuan Duan</a><sup>2, 3</sup>, </div>
            <div class="author-block">Huaxia Li</a><sup>2</sup>,</div>
            <div class="author-block">Haibo Zhao</a><sup>2</sup>,</div>
            <div class="author-block">Xu Tang</a><sup>2</sup>,</div>
            <div class="author-block">Yao Hu</a><sup>2</sup></div>
          </div>
  
          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Zhejiang University</span>,
            <span class="author-block"><sup>2</sup>Xiaohongshu</span>,
            <span class="author-block"><sup>3</sup>Shanghai Jiao Tong University</span><br>
          </div>
          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <!-- <span class="link-block">
                <a href="https://www.youtube.com/watch?v=B4ieLnS4MTY"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span> -->
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/RedAIGC/Target-Driven-Distillation"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>  
              <!-- huggingface Link. -->
              <span class="link-block">
                <a href="https://huggingface.co/RED-AIGC/TDD"
                   class="external-link button is-normal is-rounded is-dark">
                  <span>ðŸ¤—&nbsp;&nbsp;Huggingface Model</span>
                  </a>
              <!-- huggingface Demo. -->
              <span class="link-block">
                <a href="https://huggingface.co/spaces/"
                   class="external-link button is-normal is-rounded is-dark">
                  <span>ðŸ¤—&nbsp;&nbsp;Huggingface Demo</span>
                  </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!--=================Teasers==========================-->
<section class="hero teaser">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <h2 class="subtitle has-text-justified">
        <figure style="width: 100%;">
          <a href="assets/figures/overview.png">
              <img width="100%" src="static/images/tdd_compare.png" />
          </a>
        </figure>
        
      </h2 >
      
      Visual comparison among different methods. Additionally, we have released a detailed comparison between our method and TCD. Our method demonstrates advantages in both image complexity and clarity.
  
    </div>

</section>

<!--=================paper Video==========================-->
<!-- <section class="hero is-light is-small">
  <div class="columns is-centered has-text-centered"  style="margin-top: 10px; margin-bottom: 20px;">
    <div class="column is-three-fifths">
      <h2 class="title is-3">Video</h2>
      
      <div class="publication-video">
        <iframe width="560" height="315" src="https://www.youtube.com/embed/B4ieLnS4MTY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
      </div>
      
    </div>
  </div>
</section> -->


<!--=================Abstract==========================-->
<section class="hero teaser">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <!-- Abstract. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-six-fifths"><!-- <div class="column is-six-fifths"> -->
        <h2 class="title is-2, columns is-centered">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Consistency distillation methods have demonstrated significant success in accelerating generative tasks of diffusion models. However, since previous consistency distillation methods use simple and straightforward strategies in selecting target timesteps, they usually struggle with blurs and detail losses in generated images. To address these limitations, we introduce Target-Driven Distillation (<b><span style="color: red;">TDD</span></b>), which (1) adopts a delicate selection strategy of target timesteps, increasing the training efficiency; (2) utilizes decoupled guidances during training, making TDD open to post-tuning on guidance scale during inference periods; (3) can be optionally equipped with non-equidistant sampling and  <span>x<sub>0</sub></span> clipping, enabling a more flexible and accurate way for image sampling.
Experiments verify that TDD achieves state-of-the-art performance in few-step generation, offering a better choice among consistency distillation models.
      </div>
    </div>
  </div>
</section>


<!--/ Framework. -->
<section class="section hero", style="margin-top:-120px;">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-six-fifths">
        <h2 class="title is-2, columns is-centered">Pipeline</h2>
      <br>
      <h2 class="subtitle has-text-justified">
        <figure style="width: 100%;">
          <a href="assets/figures/overview.png">
              <img width="100%" src="static/images/tdd_overview.jpg" />
          </a>
        </figure>
      </h2>
    </div>
  </div>
  <p>
    We propose <b>Target-Driven Distillation (TDD)</b>, a multi-target approach that emphasizes delicately selected target timesteps during distillation processes. Our method involves three key designs: 
    <b>Firstly</b>, for any timestep, it selects a nearby timestep forward that falls into a few-step equidistant denoising schedule of a predefined set of schedules (<i>e.g.</i> 4--8 steps), which eliminates long-distance predictions while only focusing on the timesteps we will probably pass through during inference periods under different schedules. Also, TDD incorporates a stochastic offset that further pushes the selected timestep ahead towards the final target timestep, in order to accommodate non-deterministic sampling such as &gamma;-sampling.
    <b>Secondly</b>, while distilling classifier-free guidance (CFG) into the distilled models, to align with the standard training process using CFG, TDD additionally replaces a portion of the text conditions with unconditional (<i>i.e.</i> empty) prompts. With such a design, TDD is open to a proposed inference-time tuning technique on guidance scale, allowing user-specified balances between the accuracy and the richness of image contents conditioned on text prompts.
    <b>Finally</b>, TDD is optionally equipped with a non-equidistant sampling method doing short-distance predictions at initial steps and long-distance ones at later steps, which helps to improve overall image quality. Additionally, TDD adopts <span>x<sub>0</sub></span> clipping to prevent out-of-bound predictions and address the overexposure issue.
  </p>
</div>
</section>

<section class="section hero", style="margin-top:-120px;">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column">
        <h2 class="title is-3">Experiment</h2>

        <div class="content has-text-justified">
          <img src="static/images/tdd_1.png" />
        </div>
        <p class="content has-text-justified">
          Qualitative comparison of different methods under NFE for 4 to 8 steps.
        </p>

      </div>
      
    </div>
  </div>
</section>

<!-- Showcase -->
<section class="section">
  <div class="container" , style="margin-top:-80px;">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Gallery of Stable Diffusion XL + TDD</h2>
        <h2 class="subtitle has-text-centered">Images generated by TDD w/o adv and TDD w/ adv</h2>

        <!-- Supp Long Figures -->
        <div id="results-carousel-face" class="carousel results-carousel">
          <div class="item item-sdxl_1">
            <div class="carousel-content">
              <img src="static/images/tdd_show_1.png"
                      alt="sdxl_4step." style="width:800px;"/>
            </div>
          </div>
          <div class="item item-sdxl_2">
            <div class="carousel-content">
              <img src="static/images/tdd_show_2.png"
                      alt="sdxl_5step." style="width:800px;"/>
            </div>
          </div>
          <div class="item item-sdxl_3">
            <div class="carousel-content">
              <img src="static/images/tdd_show_3.png"
                      alt="sdxl_6step." style="width:800px;"/>
            </div>
          </div>
          <div class="item item-sdxl_4">
            <div class="carousel-content">
              <img src="static/images/tdd_show_4.png"
                      alt="sdxl_7step." style="width:800px;"/>
            </div>
          </div>
          <div class="item item-sdxl_5">
            <div class="carousel-content">
              <img src="static/images/tdd_show_5.png"
                      alt="sdxl_8step." style="width:800px;"/>
            </div>
          </div>
        </div>
        
        </div>
      </div>
    </div>
  </div>  
 
</section>

<!-- Showcase -->
<section class="section">
  <div class="container" , style="margin-top:-80px;">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Gallery of TDD + Different Base/Lora/ControlNet</h2>
        <h2 class="subtitle has-text-centered">Images generated by TDD w/o adv and TDD w/ adv</h2>

        <!-- Supp Long Figures -->
        <div id="results-carousel-face" class="carousel results-carousel">
          <div class="item item-sdxl_more_1">
            <div class="carousel-content">
              <img src="static/images/tdd_show_6.png"
                      alt="sdxl_diff_base." style="width:800px;"/>
            </div>
          </div>
          <div class="item item-sdxl_more_2">
            <div class="carousel-content">
              <img src="static/images/tdd_show_7.png"
                      alt="sdxl_diff_lora." style="width:800px;"/>
            </div>
          </div>
          <div class="item item-sdxl_more_3">
            <div class="carousel-content">
              <img src="static/images/tdd_show_8.png"
                      alt="sdxl_diff_ctrl." style="width:800px;"/>
            </div>
          </div>
        </div>
        
        </div>
      </div>
    </div>
  </div>  
 
</section>


<!-- <section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{,
  author    = {},
  title     = {},
  year      = {},
}</code></pre>
  </div>
</section> -->

  
<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
<!--       <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a> -->
<!--       <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a> -->
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
